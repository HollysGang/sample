# 입/출금 분산락 적용

## 1. 기능 설명
이 과제는 Redis를 사용하여 분산 락을 구현하고, 이를 통해 여러 인스턴스가 동시에 하나의 계좌에 대해 입출금을 시도할 때 발생할 수 있는 동시성 문제를 해결하는 것을 목표로 합니다.

## 2. 구현해야 할 기능
- **계좌 생성**: 사용자가 계좌를 생성할 수 있는 기능을 구현합니다.
- **입금 기능**: 특정 계좌에 금액을 입금할 수 있는 기능을 구현합니다.
- **출금 기능**: 특정 계좌에서 금액을 출금할 수 있는 기능을 구현합니다.
- **계좌 잔액 조회**: 계좌의 현재 잔액을 조회할 수 있는 기능을 구현합니다.

## 3. 비즈니스 요구사항
- **동시성 문제 방지**: 동일한 계좌에 대해 여러 인스턴스가 동시에 출금/입금을 시도할 때, 락을 통해 각 작업이 차례대로 수행되도록 해야 합니다.
- **잔액 초과 방지**: 출금 시 현재 잔액보다 많은 금액을 출금하려는 경우, 출금이 실패하도록 하고 "잔액 부족" 에러 메시지를 반환합니다.
- **로그 작성**: 입금 및 출금 작업이 성공하거나 실패할 때마다 로그를 기록하여 작업의 성공 여부와 상태를 확인할 수 있도록 합니다.

## 4. 입출금 API 명세

### 계좌 생성 API
>- **설명**: 계좌 생성 요청을 받아, 새로운 계좌 ID를 반환합니다.
>- **HTTP 메서드**: `POST`
>- **엔드포인트**: `/accounts`

### 입금 API
>- **설명**: 특정 계좌에 입금하는 요청을 받습니다.
>- **HTTP 메서드**: `POST`
>- **엔드포인트**: `/accounts/{accountId}/deposit`
>- **요청 파라미터**:
>    - `accountId` (계좌 ID)
>    - `amount` (입금 금액)

### 출금 API
>- **설명**: 특정 계좌에서 출금하는 요청을 받습니다.
>- **HTTP 메서드**: `POST`
>- **엔드포인트**: `/accounts/{accountId}/withdraw`
>- **요청 파라미터**:
>    - `accountId` (계좌 ID)
>    - `amount` (출금 금액)

### 잔액 조회 API
>- **설명**: 특정 계좌의 잔액을 조회하는 요청을 받습니다.
>- **HTTP 메서드**: `GET`
>- **엔드포인트**: `/accounts/{accountId}/balance`

## 5. 테스트 요구사항
- **동시성 테스트**: 여러 스레드 또는 여러 인스턴스에서 동시에 동일한 계좌에 입출금 요청을 보낼 때, 락이 제대로 작동하여 잔액이 올바르게 유지되는지 확인합니다.
- **에러 처리**: 잔액 부족으로 인한 출금 실패, 락 획득 실패, 기타 예외 상황에 대해 각각 적절한 에러 메시지와 상태 코드를 반환하도록 합니다.
- **재시도 로직 테스트**: 락 획득 실패 시 재시도 로직이 정상적으로 작동하는지 확인합니다.